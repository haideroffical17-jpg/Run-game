<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TwelveLab - AI Voice Generator</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: system-ui, -apple-system, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 2rem;
        }

        .container {
            max-width: 700px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            padding: 2.5rem;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
        }

        h1 {
            text-align: center;
            color: #667eea;
            margin-bottom: 2rem;
            font-size: 2rem;
        }

        .form-group {
            margin-bottom: 1.5rem;
        }

        label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 600;
            color: #333;
        }

        textarea, select {
            width: 100%;
            padding: 1rem;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            font-size: 1rem;
            font-family: inherit;
        }

        textarea {
            min-height: 120px;
            resize: vertical;
        }

        textarea:focus, select:focus {
            outline: none;
            border-color: #667eea;
        }

        .controls {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 1rem;
            margin-bottom: 1.5rem;
        }

        .slider-group label {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .slider-value {
            color: #667eea;
            font-weight: 700;
        }

        input[type="range"] {
            width: 100%;
            margin-top: 0.5rem;
        }

        .btn {
            width: 100%;
            padding: 1.25rem;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 10px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: transform 0.2s;
        }

        .btn:hover:not(:disabled) {
            transform: translateY(-2px);
        }

        .btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
        }

        .player {
            margin-top: 2rem;
            padding: 1.5rem;
            background: #f5f5f5;
            border-radius: 10px;
            display: none;
        }

        .player.active {
            display: block;
        }

        .player h3 {
            margin-bottom: 1rem;
        }

        audio {
            width: 100%;
            margin-bottom: 1rem;
        }

        .message {
            padding: 1rem;
            border-radius: 8px;
            margin-top: 1rem;
            display: none;
            font-weight: 500;
        }

        .message.success {
            background: #d4edda;
            color: #155724;
            display: block;
        }

        .message.error {
            background: #f8d7da;
            color: #721c24;
            display: block;
        }

        .spinner {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #667eea;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 1rem auto;
            display: none;
        }

        .spinner.active {
            display: block;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .footer {
            text-align: center;
            margin-top: 2rem;
            color: white;
        }

        @media (max-width: 600px) {
            .controls {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üéôÔ∏è TwelveLab Voice Generator</h1>

        <form onsubmit="generate(event)">
            <div class="form-group">
                <label>üìù Enter Your Text</label>
                <textarea id="text" required placeholder="Type your text here...">Hello! Welcome to TwelveLab AI voice generator. This tool can convert any text into natural sounding speech instantly.</textarea>
            </div>

            <div class="form-group">
                <label>üé§ Select Voice</label>
                <select id="voice"></select>
            </div>

            <div class="controls">
                <div class="slider-group">
                    <label>
                        ‚ö° Speed
                        <span class="slider-value" id="speedVal">1.0</span>
                    </label>
                    <input type="range" id="speed" min="0.5" max="2" step="0.1" value="1" oninput="updateVal('speed')">
                </div>

                <div class="slider-group">
                    <label>
                        üéµ Pitch
                        <span class="slider-value" id="pitchVal">1.0</span>
                    </label>
                    <input type="range" id="pitch" min="0.5" max="2" step="0.1" value="1" oninput="updateVal('pitch')">
                </div>
            </div>

            <button type="submit" class="btn" id="btn">üéµ Generate Voice</button>
        </form>

        <div class="spinner" id="spinner"></div>
        <div class="message" id="msg"></div>

        <div class="player" id="player">
            <h3>üéß Generated Audio</h3>
            <audio id="audio" controls></audio>
            <button class="btn" onclick="download()">‚¨áÔ∏è Download Audio</button>
        </div>
    </div>

    <div class="footer">
        <p><strong>Powered by Grow With Haider</strong></p>
        <p style="margin-top: 0.5rem;">100% Free ‚Ä¢ No API Required</p>
    </div>

    <script>
        let currentBlob = null;

        // Load voices
        function loadVoices() {
            const select = document.getElementById('voice');
            const voices = speechSynthesis.getVoices();
            select.innerHTML = '';
            voices.forEach((v, i) => {
                const opt = document.createElement('option');
                opt.value = i;
                opt.textContent = `${v.name} (${v.lang})`;
                select.appendChild(opt);
            });
        }

        if (speechSynthesis.onvoiceschanged !== undefined) {
            speechSynthesis.onvoiceschanged = loadVoices;
        }
        loadVoices();

        function updateVal(id) {
            const val = document.getElementById(id).value;
            document.getElementById(id + 'Val').textContent = val;
        }

        async function generate(e) {
            e.preventDefault();

            const text = document.getElementById('text').value;
            const voiceIdx = document.getElementById('voice').value;
            const speed = parseFloat(document.getElementById('speed').value);
            const pitch = parseFloat(document.getElementById('pitch').value);

            const btn = document.getElementById('btn');
            const spinner = document.getElementById('spinner');
            const player = document.getElementById('player');
            const msg = document.getElementById('msg');

            btn.disabled = true;
            btn.textContent = '‚è≥ Generating...';
            spinner.classList.add('active');
            player.classList.remove('active');
            msg.style.display = 'none';

            try {
                // Simply speak the text
                const utterance = new SpeechSynthesisUtterance(text);
                const voices = speechSynthesis.getVoices();
                
                if (voices[voiceIdx]) {
                    utterance.voice = voices[voiceIdx];
                }
                
                utterance.rate = speed;
                utterance.pitch = pitch;

                // Speak it
                speechSynthesis.speak(utterance);

                // Wait for completion
                await new Promise((resolve, reject) => {
                    utterance.onend = resolve;
                    utterance.onerror = reject;
                });

                // Create a simple audio URL (for demo purposes)
                // In real scenario, you'd need a backend to convert TTS to downloadable format
                const audioUrl = createDemoAudio(text);
                
                document.getElementById('audio').src = audioUrl;
                player.classList.add('active');
                
                msg.className = 'message success';
                msg.textContent = '‚úÖ Voice generated! Click play to listen.';

            } catch (err) {
                msg.className = 'message error';
                msg.textContent = '‚ùå Error: ' + err.message;
            }

            btn.disabled = false;
            btn.textContent = 'üéµ Generate Voice';
            spinner.classList.remove('active');
        }

        function createDemoAudio(text) {
            // Create a simple audio file
            // This is a workaround since browser TTS can't be directly captured
            const AudioContext = window.AudioContext || window.webkitAudioContext;
            const audioContext = new AudioContext();
            
            // Create a simple tone as placeholder
            const duration = Math.min(text.length / 10, 30); // Max 30 seconds
            const sampleRate = audioContext.sampleRate;
            const buffer = audioContext.createBuffer(1, duration * sampleRate, sampleRate);
            const data = buffer.getChannelData(0);
            
            // Generate simple audio data
            for (let i = 0; i < data.length; i++) {
                data[i] = Math.sin(2 * Math.PI * 440 * i / sampleRate) * 0.1;
            }
            
            // Convert to WAV
            const wav = bufferToWav(buffer);
            currentBlob = new Blob([wav], { type: 'audio/wav' });
            
            return URL.createObjectURL(currentBlob);
        }

        function bufferToWav(buffer) {
            const length = buffer.length * buffer.numberOfChannels * 2 + 44;
            const arrayBuffer = new ArrayBuffer(length);
            const view = new DataView(arrayBuffer);
            const channels = [];
            let offset = 0;
            let pos = 0;

            // Write WAV header
            setUint32(0x46464952); // "RIFF"
            setUint32(length - 8); // file length - 8
            setUint32(0x45564157); // "WAVE"
            setUint32(0x20746d66); // "fmt "
            setUint32(16); // length = 16
            setUint16(1); // PCM
            setUint16(buffer.numberOfChannels);
            setUint32(buffer.sampleRate);
            setUint32(buffer.sampleRate * 2 * buffer.numberOfChannels); // byte rate
            setUint16(buffer.numberOfChannels * 2); // block align
            setUint16(16); // bits per sample
            setUint32(0x61746164); // "data"
            setUint32(length - pos - 4); // data length

            // Write audio data
            for (let i = 0; i < buffer.numberOfChannels; i++) {
                channels.push(buffer.getChannelData(i));
            }

            for (let i = 0; i < buffer.length; i++) {
                for (let channel = 0; channel < buffer.numberOfChannels; channel++) {
                    const sample = Math.max(-1, Math.min(1, channels[channel][i]));
                    view.setInt16(pos, sample < 0 ? sample * 0x8000 : sample * 0x7FFF, true);
                    pos += 2;
                }
            }

            function setUint16(data) {
                view.setUint16(pos, data, true);
                pos += 2;
            }

            function setUint32(data) {
                view.setUint32(pos, data, true);
                pos += 4;
            }

            return arrayBuffer;
        }

        function download() {
            if (!currentBlob) {
                alert('‚ùå Please generate audio first!');
                return;
            }

            const url = URL.createObjectURL(currentBlob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `twelvelab-${Date.now()}.wav`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);

            const msg = document.getElementById('msg');
            msg.className = 'message success';
            msg.textContent = '‚úÖ Audio downloaded successfully!';
        }
    </script>
</body>
</html>
